function [t,p] = Ptrajectory(x,r,T)
tspan = [0 T];
ic = [0.8 0.1 0.1];
opts = odeset('RelTol',1e-8,'AbsTol',1e-8);
[t,p] = ode45(@(t,p) myode(t,p,x,r(1,:),r(2,:)), tspan, ic, opts);
end

function dpdt = myode(t,p,rt,r12,r31)
global t12 t23 t13;
r12 = interp1(rt,r12,t);
r31 = interp1(rt,r31,t);
dpdt = zeros(3,1);
dpdt(1) = p(2).*(1+r12).^(-1).*t12+p(3).*r31.*(1+r31).^(-1).*t13+(-1).*p(1).*( ...
  r12.*(1+r12).^(-1).*t12+(1+r31).^(-1).*t13);
dpdt(2) = p(1).*r12.*(1+r12).^(-1).*t12+p(3).*(1+r12.^(-1).*r31.^(-1)).^(-1).* ...
  t23+(-1).*p(2).*((1+r12).^(-1).*t12+r12.^(-1).*(1+r12.^(-1).*r31.^( ...
  -1)).^(-1).*r31.^(-1).*t23);
dpdt(3) = p(1).*(1+r31).^(-1).*t13+p(2).*r12.^(-1).*(1+r12.^(-1).*r31.^(-1)).^( ...
  -1).*r31.^(-1).*t23+(-1).*p(3).*(r31.*(1+r31).^(-1).*t13+(1+r12.^( ...
  -1).*r31.^(-1)).^(-1).*t23);
end