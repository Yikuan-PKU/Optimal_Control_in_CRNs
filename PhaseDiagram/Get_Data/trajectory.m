function [p1,p2,p3,k12,k21,k13,k31,k23,k32] = trajectory(Y,t12,t23,t13)
    p1 = Y(1,:);
    p2 = Y(2,:);
    dp1 = Y(3,:);
    dp2 = Y(4,:);
    p3 = 1-p1-p2;
    dp3 = -dp1-dp2;
    R12 = (1./p1 + 1./p2)/(2.*t12);
    R13 = (1./p1 + 1./p3)/(2.*t13);
    R23 = (1./p2 + 1./p3)/(2.*t23);
    Phi12_1 = R13./(R12+R13+R23);
    Phi12_2 = -R23./(R12+R13+R23);
    Phi13_1 = (R12+R23)./(R12+R13+R23);
    Phi13_2 = R23./(R12+R13+R23);
    Phi23_1 = R13./(R12+R13+R23);
    Phi23_2 = (R12+R13)./(R12+R13+R23);
    k12 = 1./(p1+p2).*(p2.*t12+Phi12_1.*dp1+Phi12_2.*dp2);
    k21 = t12-k12;
    k13 = 1./(p1+p3).*(p3.*t13+Phi13_1.*dp1+Phi13_2.*dp2);
    k31 = t13-k13;
    k23 = 1./(p2+p3).*(p3.*t23+Phi23_1.*dp1+Phi23_2.*dp2);
    k32 = t23-k23;
end

